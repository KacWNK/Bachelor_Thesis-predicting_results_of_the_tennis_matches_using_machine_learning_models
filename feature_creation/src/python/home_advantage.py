import pandas as pd


def add_home_advantage(new_matches: pd.DataFrame, existing_df: pd.DataFrame) -> pd.DataFrame:
    locations_to_countries = {
        'Adelaide 1': 'AUS',
        'Pune': 'IND',
        'Adelaide 2': 'AUS',
        'Auckland': 'NZL',
        'Melbourne': 'AUS',
        'Cordoba': 'ARG',
        'Dallas': 'USA',
        'Montpellier': 'FRA',
        'Buenos Aires': 'ARG',
        'Delray Beach': 'USA',
        'Rotterdam': 'NED',
        'Doha': 'QAT',
        'Marseille': 'FRA',
        'Rio de Janeiro': 'BRA',
        'Acapulco': 'MEX',
        'Dubai': 'UAE',
        'Santiago': 'CHI',
        'Indian Wells': 'USA',
        'Miami': 'USA',
        'Estoril': 'POR',
        'Houston': 'USA',
        'Marrakech': 'MAR',
        'Monte Carlo': 'MCO',
        'Barcelona': 'ESP',
        'Banja Luka': 'BIH',
        'Munich': 'GER',
        'Madrid': 'ESP',
        'Rome': 'ITA',
        'Geneva': 'SUI',
        'Lyon': 'FRA',
        'Paris': 'FRA',
        "'s-Hertogenbosch": 'NED',
        'Stuttgart': 'GER',
        'Halle': 'GER',
        'Queens Club': 'GBR',
        'Eastbourne': 'GBR',
        'Mallorca': 'ESP',
        'London': 'GBR',
        'Bastad': 'SWE',
        'Gstaad': 'SUI',
        'Newport': 'USA',
        'Atlanta': 'USA',
        'Hamburg': 'GER',
        'Umag': 'CRO',
        'Kitzbuhel': 'AUT',
        'Los Cabos': 'MEX',
        'Washington': 'USA',
        'Toronto': 'CAN',
        'Cincinnati': 'USA',
        'Winston-Salem': 'USA',
        'New York': 'USA',
        'Chengdu': 'CHN',
        'Zhuhai': 'CHN',
        'Beijing': 'CHN',
        'Nur-Sultan': 'KAZ',
        'Shanghai': 'CHN',
        'Antwerp': 'BEL',
        'Stockholm': 'SWE',
        'Tokyo': 'JPN',
        'Basel': 'SUI',
        'Gijon': 'ESP',
        'Cologne 1': 'GER',
        'Cologne 2': 'GER',
        'Vienna': 'AUT',
        'Sofia': 'BUL',
        'Paris 2': 'FRA',
        'Metz': 'FRA',
        'Sydney': 'AUS',
        'Belgrade': 'SRB',
        'Montreal': 'CAN',
        'San Diego': 'USA',
        'Moscow': 'RUS',
        'St. Petersburg': 'RUS',
        'Seoul': 'KOR',
        'Tel Aviv': 'ISR',
        'Florence': 'ITA',
        'Naples': 'ITA',
        'Antalya': 'TUR',
        'Singapore': 'SGP',
        'Cagliari': 'ITA',
        'Marbella': 'ESP',
        'Belgrade 2': 'SRB',
        'Parma': 'ITA',
        'Adelaide': 'AUS',
        'Sardinia': 'ITA',
        'Brisbane': 'AUS',
        'Sao Paulo': 'BRA',
        'Budapest': 'HUN',
        'Quito': 'ECU',
        'Istanbul': 'TUR',
        'Shenzhen': 'CHN'
    }

    locations_to_countries = {key.lower(): value for key, value in locations_to_countries.items()}

    new_matches['tournament_country'] = new_matches['tournament_location'].str.lower().map(locations_to_countries)

    new_matches['winner_home'] = (new_matches['winner_ioc'] == new_matches['tournament_country'])
    new_matches['loser_home'] = (new_matches['loser_ioc'] == new_matches['tournament_country'])
    return new_matches
